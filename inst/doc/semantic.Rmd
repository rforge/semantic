%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Introduction}
%\VignettePackage{semantic}
---
title: "semantic: An R package for RDF applications and SPARQL"
author: "W. Kaisers"
date: "09.09.2014"
bibliography: semantic.bib
output:
    html_document:
        theme: default
        toc: true
        toc_depth: 3
        number_sections: true
        highlight: null
        css: custom.css
---

```{r, message=FALSE, echo=FALSE}
library(semantic)
```

# Header settings

# The RDF data model

RDF triples
``` c
<subject> <predicate> <object>
```
 - Subject and the object represent the two resources being related;
 - The predicate represents the nature of their relationship. 
 - The relationship is called in RDF a property. 
 - Because RDF statements consist of three elements they are called triples. 
 
 ### IRI's

 - International Resource Identifier (IRI)
 - Generalization of URI: allows non-ASCII characters
 - IRIs are specified in [RFC 3987](http://www.ietf.org/rfc/rfc3987.txt)
 - Full IRIs are enclosed in angle brackets (<>)
 - The datatype is appended to the literal through a ^^ delimiter.

***Literals*** are basic values that are not IRIs.

## The SPARQL protocol

[sparql11-protocol](http://www.w3.org/TR/2013/REC-sparql11-protocol-20130321/)
desccribes the SPARQL Protocol. Section 1.2 Terminology describes

 - *SPARQL Protocol client* (client) as an HTTP client that sends HTTP requests
    for SPARQL protocol operations.
 - *SPARQL Protocol service* (service) as an HTTP server that services 
    HTTP requests and sends back HTTP responses for SPARQL Protocol operations.
    The URI at which a SPARQL Protocol service listens for requests
    is generally known as a SPARQL endpoint. 

### SPARQL protocol operations ###

SPARQL defines to operation types: query and update. Operations and 
returned messages are sent via HTTP.

 - The HTTP method by which the request is sent.
 - The HTTP query string parameters included in the HTTP request URI.
 - The message content included in the HTTP request body.
 - The message content included in the HTTP response body.

### Response formats

Response format should be selected by HTTP content negotiation.

SPARQL query answers (to SELECT and ASK) can be given as

 - XML
 - JSON
 - CSV/TSV

SPARQL query answers (to DESCRIBE and CONSTRUCT) return an RDF graph

## SPARQL syntax

### Prefix declaration

SPARQL queries allow the user to abbreviate URIs by declaring prefix
abbreviations. 
For example, the declaration
``` c
PREFIX dcterms: <http://purl.org/dc/terms/>
```

allows the URI *http://purl.org/dc/terms/Location* to be abbreviated as 
*dcterms:Location*. [Prefixes](http://prefix.cc/)

SPARQL bases on matching parts of RDF graphs: The pattern
``` c
?Location  dwc:stateProvince "Hawaii"
```
matches
```c
<http://bioimages.vanderbilt.edu/baskauf/04005#loc>  dwc:stateProvince  "Hawaii"
```
A triple pattern can also contain zero, one, two, or three variables.

# The S4 class structure inside semantic

## Namespace objects

Namespace (PREFIX) data is managed in class *Namespace*. Therefore functions 
for imporing, subspacing and export of Namespace data are provided.

From an existing *Namespace* object, the raw textual representation can
be obtained using (cat(asPrefix(nx))) as shown below.
 
```{r}
ns <- namespace("PREFIX owl: <http://www.w3.org/2002/07/owl#>")
cat(asPrefix(ns))
```


# Applications

We provide example use cases for the *semantic* package.

## Query EBI databases

Example SPARQL Queries are shown
[here](http://www.ebi.ac.uk/rdf/example-sparql-queries).

 - BioRDF [@pmid23735196].


```{r}
ef <- system.file("extdata", "ebi_ns.txt", package="semantic")
ns <- importNamespace(ef)
```

### Query Chembl

First a *Sparql* object is created and the connection to
the chembl SPARQL endpoint is tested.
```{r, eval=FALSE}
ep <- sparql("http://www.ebi.ac.uk/rdf/services/chembl/sparql")
validObject(ep)
```

We query the chembl identifier for Temozolomide.
```{r, eval=FALSE}
en <- ns["skos"]
sql <-"SELECT ?mol WHERE { ?mol skos:altLabel 'Temozolomide' . }" 
sp <- sparqlQuery(sql, en)
res <- sendQuery(ep, sp, accept="table")
rs <- resultSet(res)
```
The query returns one record. Therefrom the core information
can be retrieved as data.frame.
```{r, eval=FALSE}
dfr <- as.data.frame(rs)
```

EBI RDF platform opened on 8 Oct 2013
 - [ChEMBL-og](http://chembl.blogspot.de/2013/10/embl-ebi-rdf-platform.html)
 - [EBI documentation](https://www.ebi.ac.uk/rdf/documentation/sparql-endpoints)
 - [Archiv Chem2Bio2RDF](http://arxiv.org/pdf/1012.4759.pdf)
    = [PMID 20478034]
 - IUPAC Pharmacology [@pmid24234439]
 - ChEMBL linked open data [@pmid23657106]
 - Semantic linked data [@pmid22859915]
 - Bio LDA [@pmid21448266]


### References

* * *

```{r}
library()
```